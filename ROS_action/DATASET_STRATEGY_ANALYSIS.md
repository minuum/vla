# 데이터셋 수집 전략 분석 및 개선 방향

## 📊 현재 구성 분석

### 현재 변수 구조

```
Task: 페트병 도달 (단일 태스크)
├── 시나리오 (4개)
│   ├── 1box_left
│   ├── 1box_right
│   ├── 2box_left
│   └── 2box_right
├── 패턴 (2개)
│   ├── Core (60%)
│   └── Variant (40%)
├── 거리 (3개)
│   ├── close
│   ├── medium
│   └── far
└── 시간대 (4개)
    ├── dawn
    ├── morning
    ├── evening
    └── night
```

**총 조합 수**: 4 × 2 × 3 × 4 = **96개 조합**
**목표 데이터**: 1000~1500개
**조합당 평균**: 10.4~15.6개

---

## 🔍 VLA 업계 벤치마크 비교

### 주요 데이터셋 현황

| 데이터셋 | 에피소드 수 | Task 수 | Task당 평균 | 특징 |
|---------|-----------|---------|------------|------|
| **RT-1** | ~130K | 13 tasks | ~10K | 로봇팔 조작, 다양한 물체 |
| **RT-2** | ~130K | 13 tasks | ~10K | RT-1 확장, 웹 지식 통합 |
| **CALVIN** | ~25K | 5 tasks | ~5K | 시뮬레이션, 순차적 태스크 |
| **Open X-Embodiment** | ~1M | 100+ tasks | ~10K | 22개 로봇, 다양한 도메인 |
| **Bridge** | ~7K | 7 tasks | ~1K | 고품질 실세계 데이터 |
| **현재 프로젝트** | **1K~1.5K** | **1 task** | **1K~1.5K** | 모바일 로봇, 단일 목표 |

### 핵심 인사이트

1. **Task 다양성 > 변수 다양성**
   - RT-1/RT-2: 13개 서로 다른 task (pick, place, open, close 등)
   - Open X-Embodiment: 100+ task로 다양성 확보
   - **현재**: 1개 task에 변수만 다양화 → **비효율적**

2. **데이터 효율성**
   - RT-1: Task당 10K → 충분한 학습 데이터
   - 현재: 조합당 10~15개 → **과소한 데이터**

3. **RoboVLMs 권장사항**
   - CALVIN: 5개 task, 각 task당 ~5K
   - **다양한 task > 같은 task의 변형**

---

## ⚠️ 현재 구성의 문제점

### 1. 변수 과다 (Over-parameterization)

```
현재 구조:
- 시나리오 4개 × 패턴 2개 × 거리 3개 × 시간대 4개 = 96개 조합
- 각 조합당 10~15개 → 통계적으로 불충분
```

**문제**:
- 조합당 데이터가 너무 적어 일반화 어려움
- 시간대 변수는 학습에 거의 영향 없음 (메타데이터만)
- 거리 변수도 실제로는 큰 차이 없을 수 있음

### 2. Task 단일화

```
현재: "페트병 도달" 1개 task만
→ 모델이 단일 패턴만 학습
→ 일반화 능력 제한
```

**비교**:
- RT-1: 13개 task → 다양한 행동 패턴 학습
- 현재: 1개 task → 제한된 행동 패턴

### 3. 데이터 분산

```
현재 수집 현황 (334개):
- 1box_right: 229개 (68.6%)
- 1box_left: 105개 (31.4%)
- 2box_left: 0개
- 2box_right: 0개

→ 불균형 심각
```

---

## ✅ 현재 구성의 장점

### 1. 명확한 목표
- 단일 task에 집중 → 빠른 프로토타이핑 가능
- 평가 지표 명확

### 2. Core/Variant 구분
- Core: 표준 패턴 학습
- Variant: 다양성 확보
- **RoboVLMs와 유사한 접근** (표준 + 변형)

### 3. 실세계 데이터
- 실제 로봇으로 수집 → 시뮬레이션과 다른 현실성
- 시간대별 수집 → 조명 변화 대응

---

## 🎯 개선 방향 제안 (1000~1500개 제한)

### 전략 1: Task 다양성 확보 (추천 ⭐⭐⭐⭐⭐)

```
현재: 1 task × 96 조합 = 비효율
개선: 3~4 task × 25~30 조합 = 효율적
```

#### 제안 구조:
```
Task 1: 페트병 도달 (기존)
  - 시나리오: 4개
  - 패턴: Core만 (Variant 제거)
  - 거리: medium만 (close/far 제거)
  - 목표: 400개 (100개/시나리오)

Task 2: 특정 위치 정지
  - 목표 지점: 3개 위치
  - 패턴: Core만
  - 목표: 300개 (100개/위치)

Task 3: 장애물 회피 후 복귀
  - 시나리오: 2개
  - 목표: 300개 (150개/시나리오)

총: 1000개, 3개 task
```

**장점**:
- Task당 300~400개 → 충분한 학습 데이터
- 다양한 행동 패턴 학습
- 일반화 능력 향상

### 전략 2: 변수 단순화 (현재 구조 유지 시)

```
제거할 변수:
1. 시간대 (4개) → 제거 (메타데이터만)
2. 거리 (3개) → medium만 유지
3. Variant 패턴 → Core만 유지

남은 조합: 4 시나리오 × 1 패턴 × 1 거리 = 4개
각 조합당: 250개 → 충분한 데이터
```

**장점**:
- 단순화로 집중도 향상
- 각 시나리오당 충분한 데이터
- 빠른 수집 가능

### 전략 3: 하이브리드 접근 (균형)

```
Task: 페트병 도달 (단일)
├── 시나리오: 4개 (유지)
├── 패턴: Core만 (Variant 제거)
├── 거리: medium만 (close/far 제거)
└── 시간대: 제거 (메타데이터만)

조합: 4개
목표: 1000개 (250개/시나리오)
```

**장점**:
- 단순하면서도 충분한 데이터
- 빠른 수집 및 학습
- 실용적 접근

---

## 📊 RoboVLMs 벤치마크 기준 평가

### CALVIN Benchmark 비교

| 항목 | CALVIN | 현재 프로젝트 | 평가 |
|------|--------|--------------|------|
| **Task 수** | 5개 | 1개 | ❌ 부족 |
| **에피소드/Task** | ~5K | ~1K | ⚠️ 적음 |
| **변수 다양성** | 낮음 | 높음 | ⚠️ 과다 |
| **데이터 효율성** | 높음 | 낮음 | ❌ 비효율 |

### Open X-Embodiment 비교

| 항목 | OXE | 현재 프로젝트 | 평가 |
|------|-----|--------------|------|
| **Task 수** | 100+ | 1개 | ❌ 매우 부족 |
| **로봇 다양성** | 22개 | 1개 | ⚠️ 단일 |
| **도메인** | 다양 | 단일 | ⚠️ 제한적 |
| **에피소드/Task** | ~10K | ~1K | ⚠️ 적음 |

---

## 💡 최종 권장사항

### 🎯 우선순위 1: Task 다양성 확보

**1000~1500개 데이터셋 구성**:

```
구성 A (추천): 3 Task 구조
├── Task 1: 페트병 도달 (400개)
│   ├── 1box_left: 100개
│   ├── 1box_right: 100개
│   ├── 2box_left: 100개
│   └── 2box_right: 100개
├── Task 2: 특정 위치 정지 (300개)
│   └── 3개 위치 × 100개
└── Task 3: 장애물 회피 후 복귀 (300개)
    └── 2개 시나리오 × 150개

총: 1000개, 3 Task
```

**장점**:
- Task당 300~400개 → 충분한 학습 데이터
- 다양한 행동 패턴 학습
- RT-1/RT-2와 유사한 구조

### 🎯 우선순위 2: 변수 단순화 (Task 추가 불가 시)

**1000개 데이터셋 구성**:

```
구성 B: 단순화 구조
├── Task: 페트병 도달 (1개)
├── 시나리오: 4개
├── 패턴: Core만 (Variant 제거)
├── 거리: medium만 (close/far 제거)
└── 시간대: 제거

조합: 4개
목표: 1000개 (250개/시나리오)
```

**장점**:
- 각 시나리오당 충분한 데이터 (250개)
- 빠른 수집 가능
- 단순하고 명확한 구조

### 🎯 우선순위 3: 하이브리드 (시간 부족 시)

**1500개 데이터셋 구성**:

```
구성 C: 균형 구조
├── Task: 페트병 도달 (1개)
├── 시나리오: 4개
├── 패턴: Core만
├── 거리: medium + far (2개)
└── 시간대: 제거

조합: 8개
목표: 1500개 (187.5개/조합)
```

---

## 🔬 변수별 중요도 분석

### 필수 변수 (유지)

1. **시나리오 (4개)** ⭐⭐⭐⭐⭐
   - 1box_left/right, 2box_left/right
   - **이유**: 핵심 행동 패턴 차이
   - **데이터**: 각 250개 이상 권장

2. **패턴: Core** ⭐⭐⭐⭐⭐
   - 표준 패턴 학습 필수
   - **데이터**: 각 시나리오당 200개 이상

### 선택적 변수 (제거 고려)

1. **Variant 패턴** ⭐⭐⭐
   - **장점**: 다양성 확보
   - **단점**: 데이터 분산
   - **권장**: 제거 또는 최소화 (10~20%)

2. **거리 (close/far)** ⭐⭐
   - **장점**: 환경 다양성
   - **단점**: 실제 차이 미미할 수 있음
   - **권장**: medium만 유지

3. **시간대** ⭐
   - **장점**: 조명 변화 대응
   - **단점**: 학습에 거의 영향 없음
   - **권장**: 제거 (메타데이터만 저장)

---

## 📈 데이터 효율성 비교

### 현재 구성 (96 조합)

```
목표: 1000개
조합당: 10.4개
→ 통계적으로 불충분
→ 일반화 어려움
```

### 개선안 A (3 Task)

```
Task 1: 4 조합 × 100개 = 400개
Task 2: 3 조합 × 100개 = 300개
Task 3: 2 조합 × 150개 = 300개
총: 1000개, 조합당 100~150개
→ 충분한 학습 데이터
```

### 개선안 B (단순화)

```
4 조합 × 250개 = 1000개
→ 각 조합당 충분한 데이터
→ 빠른 수집 및 학습
```

---

## 🎓 업계 벤치마크 학습

### RT-1/RT-2 전략

- **13개 task**, 각 task당 ~10K
- **핵심**: Task 다양성 > 변수 다양성
- **현재 프로젝트 적용**: 3~4개 task로 확장

### CALVIN 전략

- **5개 task**, 각 task당 ~5K
- **핵심**: 순차적 task 학습
- **현재 프로젝트 적용**: Task 간 연계 고려

### Open X-Embodiment 전략

- **100+ task**, 다양한 로봇
- **핵심**: 도메인 다양성
- **현재 프로젝트 적용**: 제한적 (단일 로봇)

---

## ✅ 최종 결론 및 권장사항

### 현재 구성 평가

**변수가 너무 많은가?** → **YES** ⚠️

**이유**:
1. 96개 조합으로 데이터 분산
2. 조합당 10~15개 → 통계적으로 불충분
3. 시간대 변수는 학습에 영향 없음
4. 거리 변수도 실제 차이 미미

### 권장 개선 방향

#### 🥇 1순위: Task 다양성 확보

```
3 Task × 각 300~400개 = 1000~1200개
→ RT-1/RT-2와 유사한 구조
→ 일반화 능력 향상
```

#### 🥈 2순위: 변수 단순화

```
4 시나리오 × 250개 = 1000개
→ 빠른 수집
→ 충분한 학습 데이터
```

#### 🥉 3순위: 하이브리드

```
4 시나리오 × 2 거리 × 187개 = 1500개
→ 균형잡힌 접근
```

### 실행 가능성

**시간 제약 (1000~1500개)**:
- **구성 B (단순화)** 추천
- 빠른 수집 가능
- 충분한 학습 데이터
- 실용적 접근

**시간 여유 시**:
- **구성 A (Task 다양성)** 추천
- 더 나은 일반화
- 업계 벤치마크와 유사

---

## 📝 참고: RoboVLMs 데이터셋 구조

### CALVIN Dataset
- **Task**: 5개 (pick, push, slide, open, close)
- **에피소드**: ~25K
- **구조**: Task별 명확한 분리

### Open X-Embodiment
- **Task**: 100+ tasks
- **에피소드**: ~1M
- **구조**: Task 중심, 변수는 최소화

### 현재 프로젝트
- **Task**: 1개
- **에피소드**: 1K~1.5K
- **구조**: 변수 중심 (비효율적)

**→ Task 중심으로 전환 필요**

