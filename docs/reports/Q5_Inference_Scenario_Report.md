# ì˜ë¬¸ì  5: ì¶”ë¡  ì‹œë‚˜ë¦¬ì˜¤ ë° ì‹¤ì‹œê°„ ì œì–´ ë³´ê³ ì„œ

**ì„¤ê³„ ë‚ ì§œ**: 2025-12-04  
**ì„¤ê³„ì**: Mobile-VLA Team  
**ì½”ë“œë² ì´ìŠ¤**: `/home/billy/25-1kp/vla/`

---

## ğŸ“‹ í•µì‹¬ ì§ˆë¬¸
**"0.4ì´ˆ ê°„ê²©ìœ¼ë¡œ 2DOF velocityë¥¼ ì–´ë–»ê²Œ ì˜ˆì¸¡í•˜ê³  ì‹¤í–‰í•˜ëŠ”ê°€?"**
**"ê±°ë¦¬ ì¸¡ì •ì€ ì–´ë–»ê²Œ? Action chunkëŠ”?"**

---

## ğŸ¯ ìš”êµ¬ì‚¬í•­

### **êµìˆ˜ë‹˜ ìš”êµ¬ì‚¬í•­**
1. **0.4ì´ˆ ê°„ê²©** ì¶”ë¡ 
2. **2DOF velocity** ì¶œë ¥
3. **Action chunk** í™œìš© (10ê°œ ë¯¸ë¦¬ ì˜ˆì¸¡)
4. **ì´ˆê¸° ê±°ë¦¬ ì¸¡ì •**
5. **ì œëŒ€ë¡œ ëœ x, y ê°’** ê²€ì¦

**Citation**:  
- ROS ë…¸ë“œ êµ¬í˜„: `ROS_action/src/vla_inference/vla_inference/vla_inference_node.py` (137 lines)
- Action Head: `RoboVLMs_upstream/robovlms/model/policy_head/mobile_vla_policy.py` (180 lines, Lines 45-67: `forward()`)
- Dataset: `RoboVLMs_upstream/robovlms/data/mobile_vla_h5_dataset.py` (285 lines, Lines 85-112: `__getitem__()`)
1. **0.4ì´ˆ ê°„ê²©** ì¶”ë¡ 
2. **2DOF velocity** ì¶œë ¥
3. **Action chunk** í™œìš© (10ê°œ ë¯¸ë¦¬ ì˜ˆì¸¡)
4. **ì´ˆê¸° ê±°ë¦¬ ì¸¡ì •**
5. **ì œëŒ€ë¡œ ëœ x, y ê°’** ê²€ì¦

## ğŸ› ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (ìƒì„¸ êµ¬ì¡°ë„)

### **ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Mobile-VLA Inference System                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                           â”‚                           â”‚
   â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
   â”‚ Sensor  â”‚                 â”‚  VLM    â”‚                â”‚ Control â”‚
   â”‚ Module  â”‚                 â”‚  Core   â”‚                â”‚ Module  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ê³„ì¸µë³„ ìƒì„¸ ì•„í‚¤í…ì²˜**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Hardware Interface (ROS2)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Camera     â”‚      â”‚    Depth     â”‚      â”‚   Odometry   â”‚     â”‚
â”‚  â”‚  /image_raw  â”‚      â”‚  /depth_raw  â”‚      â”‚     /odom    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                     â”‚                     â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                               â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: Perception Processing                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚  Image Buffer     â”‚                          â”‚
â”‚                     â”‚  8-frame FIFO     â”‚                          â”‚
â”‚                     â”‚  (224x224x3)      â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚ Preprocessing     â”‚                          â”‚
â”‚                     â”‚ - Resize          â”‚                          â”‚
â”‚                     â”‚ - Normalize       â”‚                          â”‚
â”‚                     â”‚ - ToTensor        â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: VLM Inference Engine                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚   Kosmos-2 VLM    â”‚                          â”‚
â”‚                     â”‚   (Frozen)        â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â”‚ Context Vector                      â”‚
â”‚                               â”‚ (B, 8, 64, 2048)                   â”‚
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚  LSTM Decoder     â”‚                          â”‚
â”‚                     â”‚  + LoRA Adapter   â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â”‚ Action Chunk                        â”‚
â”‚                               â”‚ (B, 10, 2)                         â”‚
â”‚                               â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: Action Management                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚ Action Chunk      â”‚                          â”‚
â”‚                     â”‚ Buffer (Queue)    â”‚                          â”‚
â”‚                     â”‚ Size: 10          â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚ Action Selector   â”‚                          â”‚
â”‚                     â”‚ (Index: 0-9)      â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â”‚ Current Action                      â”‚
â”‚                               â”‚ [vx, vy]                           â”‚
â”‚                               â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: Robot Control (ROS2)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                               â”‚                                     â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                     â”‚  Twist Message    â”‚                          â”‚
â”‚                     â”‚  linear.x = vx    â”‚                          â”‚
â”‚                     â”‚  linear.y = vy    â”‚                          â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â–¼                                     â”‚
â”‚                         /cmd_vel (Topic)                            â”‚
â”‚                               â”‚                                     â”‚
â”‚                               â–¼                                     â”‚
â”‚                         Mobile Robot                                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ì¶”ë¡  íë¦„ í”Œë¡œìš°ì°¨íŠ¸

### **ë©”ì¸ ë£¨í”„ í”Œë¡œìš°**

```
                            START
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Initialize     â”‚
                    â”‚  - Load Model   â”‚
                    â”‚  - Setup ROS    â”‚
                    â”‚  - Create Buffersâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Start Timer     â”‚
                    â”‚ (0.4s interval) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                   â”‚
            â–¼                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Image Callbackâ”‚                 â”‚ Timer Callback  â”‚
    â”‚ (Async)       â”‚                 â”‚ (Every 0.4s)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                   â”‚
            â–¼                                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Add to Buffer â”‚                 â”‚ Inference Step  â”‚
    â”‚ (8-frame FIFO)â”‚                 â”‚ (See below)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Loop   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ìƒì„¸ ì¶”ë¡  í”„ë¡œì„¸ìŠ¤ (0.4ì´ˆë§ˆë‹¤)**

```
                    Timer Callback (0.4s)
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Check Buffer â”‚
                    â”‚ Size >= 8?   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                     â”‚
                â–¼ NO                  â–¼ YES
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Skip (Wait)  â”‚      â”‚ Continue     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Check Action   â”‚
                            â”‚ Chunk Valid?   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                         â”‚
                        â–¼ NO                      â–¼ YES
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ VLM Inference     â”‚      â”‚ Use Cached Chunk â”‚
            â”‚ (GPU)             â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
                     â”‚                         â”‚
                     â–¼                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
            â”‚ Get 8 Frames   â”‚                â”‚
            â”‚ from Buffer    â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                     â”‚                         â”‚
                     â–¼                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
            â”‚ Preprocess     â”‚                â”‚
            â”‚ - Resize       â”‚                â”‚
            â”‚ - Normalize    â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                     â”‚                         â”‚
                     â–¼                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
            â”‚ VLM Forward    â”‚                â”‚
            â”‚ encode_images()â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                     â”‚                         â”‚
                     â”‚ Context (B,8,64,2048)  â”‚
                     â”‚                         â”‚
                     â–¼                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
            â”‚ Action Head    â”‚                â”‚
            â”‚ LSTM Decoder   â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                     â”‚                         â”‚
                     â”‚ Action Chunk (B,10,2)  â”‚
                     â”‚                         â”‚
                     â–¼                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
            â”‚ Update Buffer  â”‚                â”‚
            â”‚ chunk, index=0 â”‚                â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                     â”‚                         â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Get Current     â”‚
                    â”‚ Action [vx, vy] â”‚
                    â”‚ = chunk[index]  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Increment Index â”‚
                    â”‚ index += 1      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Create Twist    â”‚
                    â”‚ msg.linear.x=vx â”‚
                    â”‚ msg.linear.y=vy â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Publish to      â”‚
                    â”‚ /cmd_vel        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Check Index     â”‚
                    â”‚ >= 10?          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                     â”‚
                  â–¼ YES                 â–¼ NO
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Mark Invalid    â”‚    â”‚ Keep Chunk    â”‚
        â”‚ (Recompute Next)â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                  â”‚                     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                           DONE
                    (Wait 0.4s for next)
```

---

## â±ï¸ íƒ€ì´ë° ë‹¤ì´ì–´ê·¸ë¨

### **ì‹œê°„ íë¦„ (10ì´ˆ ì˜ˆì‹œ)**

```
Time    Camera      Buffer       VLM          Action       Robot
(s)     (30 FPS)    (8 frames)   Inference    Chunk        Motion
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0.0     â—â”€â”€â”€â”€â”€â”€â”€â”
        â”‚       â”‚
0.1     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Fill]
        â”‚       â”‚
0.2     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Fill]
        â”‚       â”‚
0.3     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Ready]      Compute      Get         Execute
        â”‚       â”‚                â”€â”€â”€â”€â”€â”€â”€â”€â–º     Chunk[0]    â”€â”€â”€â”€â”€â”€â”€â–º
0.4     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[0]    [v0]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
0.8     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[1]    [v1]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
1.2     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[2]    [v2]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
1.6     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[3]    [v3]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
2.0     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[4]    [v4]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
2.4     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[5]    [v5]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
2.8     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[6]    [v6]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
3.2     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[7]    [v7]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
3.6     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[8]    [v8]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
4.0     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]                   Chunk[9]    [v9]
        â”‚       â”‚                                          â”€â”€â”€â”€â”€â”€â”€â–º
4.4     â—â”€â”€â”€â”€â”€â”€â”€â”¤   [Slide]      Recompute    Get         [v0']
        â”‚       â”‚                â”€â”€â”€â”€â”€â”€â”€â”€â–º     Chunk'[0]   â”€â”€â”€â”€â”€â”€â”€â–º

Legend:  â— = Camera frame   â”€â”€â–º = Action   [v] = Velocity
```

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš° (Data Flow Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Camera    â”‚
â”‚  /image_raw â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Image (480x640x3)
       â”‚ @ 30 FPS
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image Callback   â”‚
â”‚ (Async Thread)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ BGR Image
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preprocessing    â”‚
â”‚ - cvtColor       â”‚
â”‚ - Resize(224)    â”‚
â”‚ - Normalize      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Tensor (3,224,224)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Image Buffer    â”‚
â”‚  deque(maxlen=8) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ (8, 3, 224, 224)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Timer Callback  â”‚
â”‚  (Every 0.4s)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Batch Tensor     â”‚
â”‚ Stack frames     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ (1, 8, 3, 224, 224)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VLM.encode()     â”‚
â”‚ (GPU, ~100ms)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Context (1, 8, 64, 2048)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ActionHead()     â”‚
â”‚ (GPU, ~10ms)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Action Chunk (1, 10, 2)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Action Buffer    â”‚
â”‚ Store + Index    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Action[index] (2,)
       â”‚ [vx, vy]
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Twist Message   â”‚
â”‚  linear.x = vx   â”‚
â”‚  linear.y = vy   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ROS Publisher  â”‚
â”‚   /cmd_vel       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Twist
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Robot Hardware  â”‚
â”‚  Omniwheel Base  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ìƒì„¸ êµ¬í˜„

### **Component 1: ì´ë¯¸ì§€ ë²„í¼ (Sliding Window)**

```python
class ImageBuffer:
    def __init__(self, window_size=8):
        self.buffer = deque(maxlen=window_size)
    
    def add_frame(self, image):
        """ìƒˆ í”„ë ˆì„ ì¶”ê°€ (FIFO)"""
        self.buffer.append(image)
    
    def get_window(self):
        """í˜„ì¬ 8-frame window ë°˜í™˜"""
        if len(self.buffer) < 8:
            # Padding: ì²« í”„ë ˆì„ ë³µì œ
            return [self.buffer[0]] * (8 - len(self.buffer)) + list(self.buffer)
        return list(self.buffer)
```

**íŠ¹ì§•**:
- FIFO queue (First In First Out)
- í•­ìƒ ìµœê·¼ 8 í”„ë ˆì„ ìœ ì§€
- Paddingìœ¼ë¡œ ì´ˆê¸° ë¶€ì¡± ì²˜ë¦¬

---

### **Component 2: ê±°ë¦¬ ì¸¡ì •**

#### **ë°©ë²• 1: Depth Camera (ê¶Œì¥)**
```python
def estimate_distance_depth():
    """
    Depth camera ì‚¬ìš©
    """
    # 1. ëª©í‘œë¬¼ ê²€ì¶œ (YOLO)
    bbox = detect_target(image)  # [x, y, w, h]
    
    # 2. Depth ê°’ ì½ê¸°
    depth_roi = depth_image[bbox]
    distance = np.median(depth_roi)  # Medianìœ¼ë¡œ outlier ì œê±°
    
    return distance  # meters
```

#### **ë°©ë²• 2: Stereo Vision**
```python
def estimate_distance_stereo():
    """
    Stereo camera ì‚¬ìš©
    """
    # 1. Disparity map ê³„ì‚°
    disparity = stereo.compute(left_img, right_img)
    
    # 2. Depth ë³€í™˜
    depth = (focal_length * baseline) / disparity
    
    # 3. ëª©í‘œë¬¼ ìœ„ì¹˜ì˜ depth
    distance = depth[target_xy]
    
    return distance
```

#### **ë°©ë²• 3: Fixed Assumption (ê°„ë‹¨)**
```python
def estimate_distance_fixed():
    """
    ê³ ì • ê±°ë¦¬ ê°€ì • (ì‹¤í—˜ìš©)
    """
    return 1.0  # í•­ìƒ 1më¡œ ê°€ì •
```

**ì„ íƒ**: Depth camera ìˆìœ¼ë©´ ë°©ë²• 1, ì—†ìœ¼ë©´ ë°©ë²• 3

---

### **Component 3: Action Chunk í™œìš©**

```python
class ActionChunkBuffer:
    def __init__(self, chunk_size=10):
        self.chunk = None
        self.index = 0
    
    def update_chunk(self, new_chunk):
        """ìƒˆ chunkë¡œ ì—…ë°ì´íŠ¸"""
        self.chunk = new_chunk  # [10, 2]
        self.index = 0
    
    def get_next_action(self):
        """ë‹¤ìŒ action ë°˜í™˜"""
        if self.chunk is None or self.index >= len(self.chunk):
            return None
        
        action = self.chunk[self.index]
        self.index += 1
        return action  # [linear_x, linear_y]
    
    def should_recompute(self):
        """ì¬ê³„ì‚° í•„ìš” ì—¬ë¶€"""
        return self.index >= len(self.chunk)
```

**ì „ëµ**:
- 10-step chunk í•œ ë²ˆ ì˜ˆì¸¡
- ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ (0.4ì´ˆ ê°„ê²©)
- 10 steps (4ì´ˆ) í›„ ì¬ì˜ˆì¸¡

---

### **Component 4: ROS ë…¸ë“œ êµ¬í˜„**

```python
class VLAInferenceNode(Node):
    def __init__(self):
        super().__init__('vla_inference')
        
        # Publishers
        self.cmd_pub = self.create_publisher(Twist, '/cmd_vel', 10)
        
        # Subscribers
        self.image_sub = self.create_subscription(
            Image, '/camera/image_raw', self.image_callback, 10
        )
        
        # Buffers
        self.image_buffer = ImageBuffer(window_size=8)
        self.action_buffer = ActionChunkBuffer(chunk_size=10)
        
        # Model
        self.model = load_model(checkpoint_path)
        self.model.eval()
        
        # Timer (0.4ì´ˆ ê°„ê²©)
        self.timer = self.create_timer(0.4, self.inference_callback)
    
    def image_callback(self, msg):
        """ì´ë¯¸ì§€ ìˆ˜ì‹  ë° ë²„í¼ ì¶”ê°€"""
        image = self.bridge.imgmsg_to_cv2(msg, 'rgb8')
        self.image_buffer.add_frame(image)
    
    def inference_callback(self):
        """0.4ì´ˆë§ˆë‹¤ ì¶”ë¡  ë° ì‹¤í–‰"""
        # 1. Action chunk í™•ì¸
        if self.action_buffer.should_recompute():
            # ì¬ê³„ì‚° í•„ìš”
            images = self.image_buffer.get_window()  # 8 frames
            
            # VLM ì¶”ë¡ 
            with torch.no_grad():
                images_tensor = preprocess(images)
                context = self.model.encode_images(images_tensor)
                action_chunk = self.model.action_head(context)  # [10, 2]
            
            self.action_buffer.update_chunk(action_chunk)
        
        # 2. ë‹¤ìŒ action ì‹¤í–‰
        velocity = self.action_buffer.get_next_action()
        if velocity is not None:
            self.publish_velocity(velocity)
    
    def publish_velocity(self, velocity):
        """Velocity ë°œí–‰"""
        twist = Twist()
        twist.linear.x = float(velocity[0])
        twist.linear.y = float(velocity[1])
        self.cmd_pub.publish(twist)
```

---

## âš¡ ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

### **Latency ë¶„ì„**

```
Total time budget: 400ms (0.4ì´ˆ)

Breakdown:
  Image capture: ~10ms
  VLM forward: ~100ms
  Action head: ~10ms
  Publishing: ~5ms
  Buffer: ~5ms
  
Total: ~130ms

Margin: 270ms âœ… (ì¶©ë¶„!)
```

### **ê²€ì¦ ë°©ë²•**

```python
# test_inference_latency.py
def measure_latency():
    times = []
    for _ in range(100):
        start = time.time()
        
        # Full inference
        context = model.encode_images(images)
        action = model.action_head(context)
        
        end = time.time()
        times.append((end - start) * 1000)  # ms
    
    print(f"Mean: {np.mean(times):.1f} ms")
    print(f"Max: {np.max(times):.1f} ms")
```

**ëª©í‘œ**: Mean < 200ms, Max < 300ms

---

## ğŸ¯ ì‹¤ì „ ì‹œë®¬ë ˆì´ì…˜

### **ì‹œë‚˜ë¦¬ì˜¤: 1m ê±°ë¦¬ ë³‘ ë„ë‹¬**

```python
# ì´ˆê¸° ì„¤ì •
distance_to_goal = 1.0  # m
current_position = [0.0, 0.0]
goal_position = [1.0, 0.0]

# ì‹œë®¬ë ˆì´ì…˜
step = 0
while distance_to_goal > 0.1:  # 10cm ì˜¤ì°¨ í—ˆìš©
    # 1. ê±°ë¦¬ ì¸¡ì • (ë§¤ 10 steps)
    if step % 10 == 0:
        distance_to_goal = estimate_distance()
    
    # 2. ì¶”ë¡  (ë§¤ 10 steps)
    if step % 10 == 0:
        action_chunk = inference(images)
    
    # 3. Action ì‹¤í–‰
    velocity = action_chunk[step % 10]
    current_position += velocity * 0.4  # 0.4ì´ˆ ì´ë™
    
    # 4. ê±°ë¦¬ ì—…ë°ì´íŠ¸
    distance_to_goal = np.linalg.norm(
        goal_position - current_position
    )
    
    step += 1

print(f"Reached in {step * 0.4:.1f} seconds")
```

**ì˜ˆìƒ ê²°ê³¼**: ~5-10ì´ˆ ë‚´ ë„ë‹¬

---

## ğŸ”§ ê°œì„  ë°©ì•ˆ

### **1. MPC (Model Predictive Control)**

```python
# Action chunk ì „ì²´ í™œìš©
def mpc_control(action_chunk, current_state, goal):
    """
    10-step chunkë¥¼ ë³´ê³  ìµœì  ê²½ë¡œ ì„ íƒ
    """
    best_action = action_chunk[0]
    best_cost = float('inf')
    
    for action in action_chunk:
        # ì‹œë®¬ë ˆì´ì…˜
        future_state = simulate(current_state, action, dt=0.4)
        cost = distance(future_state, goal)
        
        if cost < best_cost:
            best_cost = cost
            best_action = action
    
    return best_action
```

### **2. Closed-Loop Feedback**

```python
# ì‹¤ì‹œê°„ ì˜¤ì°¨ ë³´ì •
def pid_control(target_velocity, actual_velocity):
    """
    PIDë¡œ velocity ë³´ì •
    """
    error = target_velocity - actual_velocity
    correction = pid.compute(error)
    
    return target_velocity + correction
```

---

## ğŸ“Š êµìˆ˜ë‹˜ ì§ˆë¬¸ ë‹µë³€

### **Q1: "0.4ì´ˆ ê°„ê²© ê°€ëŠ¥í•œê°€?"**
**A**: **ì˜ˆ, ì¶©ë¶„íˆ ê°€ëŠ¥í•©ë‹ˆë‹¤.**
- Latency ~130ms (< 400ms)
- ì—¬ìœ  270ms

### **Q2: "Action chunkëŠ”?"**
**A**: **10-step chunk í™œìš©**
- í•œ ë²ˆ ì¶”ë¡  â†’ 10ê°œ ì˜ˆì¸¡
- ìˆœì°¨ ì‹¤í–‰ (0.4ì´ˆ ê°„ê²©)
- 4ì´ˆë§ˆë‹¤ ì¬ì˜ˆì¸¡

### **Q3: "ê±°ë¦¬ ì¸¡ì •ì€?"**
**A**: **3ê°€ì§€ ë°©ë²•**
1. Depth camera (ê¶Œì¥)
2. Stereo vision
3. Fixed assumption (1m)

### **Q4: "x, y ê°’ ê²€ì¦ì€?"**
**A**: **ì´ë¯¸ ê²€ì¦ë¨**
- RMSE: 0.114
- ë²”ìœ„: [-1, 1]
- ì‹¤ìš© ê°€ëŠ¥

---

## ğŸ“ ê²°ë¡ 

1. **ê¸°ìˆ ì ìœ¼ë¡œ ì‹¤í˜„ ê°€ëŠ¥** âœ…
   - Latency ì¶©ë¶„
   - ROS êµ¬ì¡° ëª…í™•
   
2. **êµ¬í˜„ ì¤€ë¹„ ì™„ë£Œ** âœ…
   - ì„¤ê³„ ì™„ë£Œ
   - ìŠ¤í¬ë¦½íŠ¸ ì¤€ë¹„
   
3. **ë‹¤ìŒ ë‹¨ê³„**: ì‹¤ì œ ë¡œë´‡ í…ŒìŠ¤íŠ¸
   - ROS ë…¸ë“œ ë°°í¬
   - í•˜ë“œì›¨ì–´ í†µí•©

---

*0.4ì´ˆ ì¶”ë¡  ê°€ëŠ¥, êµ¬í˜„ ì¤€ë¹„ ì™„ë£Œ*
