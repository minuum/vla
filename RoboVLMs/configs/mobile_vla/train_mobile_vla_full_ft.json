{
  "robovlm_name": "RoboKosMos",
  "parent": null,
  "task_name": "mobile_vla_full_finetune",
  "model": "kosmos",
  "model_url": "https://huggingface.co/microsoft/kosmos-2-patch14-224",
  "seq_len": 9,
  "image_size": 224,
  "image_mean": [0.48145466, 0.4578275, 0.40821073],
  "image_std": [0.26862954, 0.26130258, 0.27577711],
  "window_size": 8,
  "fwd_pred_next_n": 1,
  "arm_gripper_loss_ratio": 0.01,
  "cap_loss_ratio": 0.0,
  "fwd_loss_ratio": 0,
  "seed": 123,
  "batch_size": 4,
  "num_workers": 4,
  "optimizer": "adamw",
  "learning_rate": 1e-5,
  "min_lr_scale": 0.1,
  "weight_decay": 0.01,
  "warmup_epochs": 2,
  "warmup_steps": 0,
  "use_hand_rgb": false,
  "use_time_causal_attn": false,
  "use_mim_obs_loss": false,
  "use_pixel_loss": false,
  "use_obs_queries": false,
  "use_vision_resampler": false,
  "vision_masked_ratio": 0.0,
  "use_tube_mask": false,
  "output_root": "runs/mobile_vla/checkpoints",
  "log_root": "runs/mobile_vla/logs",
  "cache_root": "runs/cache",
  "model_load_path": null,
  "model_load_source": "torch",
  "resume": null,
  "model_path": ".vlms/kosmos-2-patch14-224",
  "model_config": ".vlms/kosmos-2-patch14-224/config.json",
  "train_setup": {
    "precision": "bf16",
    "predict_action": true,
    "predict_forward": false,
    "predict_forward_hand": false,
    "predict_caption": false,
    "train_vision": true,
    "bits": -1,
    "freeze_mm_mlp_adapter": false,
    "freeze_backbone": false,
    "freeze_resampler": false,
    "tune_mm_mlp_adapter": false,
    "mm_use_im_start_end": false,
    "mm_use_im_patch_token": false,
    "gradient_checkpointing": false,
    "lora_enable": false,
    "mm_projector_lr": 1e-4,
    "lora_r": 64,
    "lora_alpha": 16,
    "lora_dropout": 0.05,
    "lora_bias": "none",
    "train_text_embedding": true,
    "train_full_decoder": false,
    "train_decoder_layers": -1
  },
  "vision_resampler": null,
  "act_encoder": null,
  "act_head": {
    "type": "LSTMDecoder",
    "hidden_size": 1024,
    "action_dim": 2,
    "down_sample": "pooling",
    "latent": 1,
    "fwd_pred_next_n": 1,
    "window_size": 8,
    "action_space": "continuous",
    "with_history": true,
    "history_type": "post",
    "dropout": 0.1
  },
  "fwd_head": null,
  "tokenizer": {
    "type": "AutoProcessor",
    "pretrained_model_name_or_path": "microsoft/kosmos-2-patch14-224",
    "tokenizer_type": "kosmos",
    "max_text_len": 256,
    "use_local_files": false,
    "additional_special_tokens": null
  },
  "vlm": {
    "type": "AutoModelForVision2Seq",
    "name": "kosmos",
    "pretrained_model_name_or_path": "microsoft/kosmos-2-patch14-224"
  },
  "trainer": {
    "accelerator": "gpu",
    "strategy": "auto",
    "precision": "bf16-mixed",
    "logger": ["tensorboard"],
    "gradient_clip_val": 1.0,
    "use_distributed_sampler": false,
    "log_every_n_steps": 10,
    "max_epochs": 50,
    "val_check_interval": 0.5,
    "check_val_every_n_epoch": 1,
    "max_steps": -1,
    "accumulate_grad_batches": 1,
    "enable_checkpointing": true,
    "default_root_dir": "runs/mobile_vla"
  },
  "train_dataset": {
    "type": "MobileVLADataset",
    "data_dir": "/home/billy/25-1kp/vla/ROS_action/mobile_vla_dataset",
    "model_name": "kosmos",
    "window_size": 8,
    "chunk_size": 1,
    "image_size": 224,
    "normalize_actions": true,
    "action_dim": 2,
    "augmentation": {
      "random_crop": false,
      "random_flip": false,
      "color_jitter": 0.1,
      "gaussian_noise": 0.01
    }
  },
  "val_dataset": {
    "type": "MobileVLADataset",
    "data_dir": "/home/billy/25-1kp/vla/ROS_action/mobile_vla_dataset",
    "model_name": "kosmos",
    "window_size": 8,
    "chunk_size": 1,
    "image_size": 224,
    "normalize_actions": true,
    "action_dim": 2,
    "split": "val"
  },
  "norm_action": true,
  "norm_min": -1.0,
  "norm_max": 1.0,
  "scheduler": "cosine",
  "on_device_optimization": {
    "enable": true,
    "target_device": "jetson_orin_nx_16gb",
    "memory_optimization": {
      "use_gradient_checkpointing": true,
      "offload_to_cpu": false,
      "mixed_precision": "bf16-mixed",
      "max_memory_gb": 14
    },
    "compute_optimization": {
      "use_torch_compile": false,
      "enable_flash_attention": false
    }
  },
  "action_bounds": {
    "linear_x": [-2.0, 2.0],
    "linear_y": [-1.15, 1.15]
  },
  "action_descriptions": {
    "linear_x": "Forward/backward velocity (m/s)",
    "linear_y": "Left/right velocity (m/s)"
  }
}

