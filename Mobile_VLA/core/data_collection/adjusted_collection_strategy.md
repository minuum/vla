# 조정된 데이터 수집 전략

## 1. 수집 계획 조정 이유

### 1.1 환경적 제약사항
- **자연광 환경**: 창 앞 테이핑 맵에서 자연광이 들어옴
- **조명 변화**: 낮 시간대에 조명 변화와 그림자 효과 발생
- **태스크 복잡성**: 조명 변화로 인한 학습 복잡도 증가

### 1.2 조정 목표
- **태스크 복잡성 최소화**: 일정한 조명 조건 우선
- **학습 효율성 향상**: 안정적인 환경에서 데이터 수집
- **품질 보장**: 일관된 조명 조건으로 높은 품질 확보

## 2. 조정된 수집 계획

### 2.1 시간대별 분배 (1000개 에피소드)

| **시간대** | **기존 계획** | **조정된 계획** | **변화** | **이유** |
|------------|---------------|-----------------|----------|----------|
| **밤 (20:00-22:00)** | 100개 (10%) | 400개 (40%) | +300개 | 일정한 조명 조건 |
| **새벽 (00:00-04:00)** | 200개 (20%) | 400개 (40%) | +200개 | 가장 안정적인 조명 |
| **낮 (13:00-15:00)** | 300개 (30%) | 200개 (20%) | -100개 | 자연광으로 인한 복잡성 |
| **추가 수집** | 400개 (40%) | 0개 (0%) | -400개 | 기존 계획에 통합 |

### 2.2 조명 조건별 특성

**밤 시간대 (20:00-22:00) - 우선순위 1**
```python
LIGHTING_CONDITIONS = {
    "primary": "형광등",
    "natural_light": "없음",
    "stability": "높음",
    "complexity": "낮음",
    "consistency": "매우 높음"
}
```

**새벽 시간대 (00:00-04:00) - 우선순위 2**
```python
LIGHTING_CONDITIONS = {
    "primary": "형광등",
    "natural_light": "없음",
    "stability": "최고",
    "complexity": "최저",
    "consistency": "최고"
}
```

**낮 시간대 (13:00-15:00) - 최소화**
```python
LIGHTING_CONDITIONS = {
    "primary": "형광등 + 자연광",
    "natural_light": "창 앞 테이핑 맵",
    "stability": "낮음",
    "complexity": "높음",
    "consistency": "낮음",
    "challenges": [
        "조명 변화",
        "그림자 효과",
        "시간대별 밝기 차이"
    ]
}
```

## 3. 수집 일정 조정

### 3.1 1주차: 밤 시간대 집중 수집

**목표**: 200개 에피소드 (기존 100개 → 200개)
**일정**:
- **월요일**: 20:00-22:00 (40개 에피소드)
- **화요일**: 20:00-22:00 (40개 에피소드)
- **수요일**: 20:00-22:00 (40개 에피소드)
- **목요일**: 20:00-22:00 (40개 에피소드)
- **금요일**: 20:00-22:00 (40개 에피소드)

**장점**:
- 일정한 조명 조건
- 태스크 복잡성 최소화
- 높은 데이터 품질

### 3.2 2주차: 새벽 시간대 집중 수집

**목표**: 200개 에피소드 (기존 200개 → 200개)
**일정**:
- **월요일**: 00:00-04:00 (40개 에피소드)
- **화요일**: 00:00-04:00 (40개 에피소드)
- **수요일**: 00:00-04:00 (40개 에피소드)
- **목요일**: 00:00-04:00 (40개 에피소드)
- **금요일**: 00:00-04:00 (40개 에피소드)

**장점**:
- 가장 안정적인 조명 조건
- 최고의 데이터 일관성
- 학습 복잡도 최소화

### 3.3 3주차: 낮 시간대 최소 수집

**목표**: 200개 에피소드 (기존 300개 → 200개)
**일정**:
- **월요일**: 13:00-15:00 (40개 에피소드)
- **화요일**: 13:00-15:00 (40개 에피소드)
- **수요일**: 13:00-15:00 (40개 에피소드)
- **목요일**: 13:00-15:00 (40개 에피소드)
- **금요일**: 13:00-15:00 (40개 에피소드)

**주의사항**:
- 창 앞 테이핑 맵 위치 고려
- 자연광 변화 모니터링
- 그림자 효과 최소화

### 3.4 4주차: 추가 수집 및 검증

**목표**: 400개 에피소드 추가 수집
**일정**: 밤/새벽 시간대 우선
**검증**: 전체 데이터셋 품질 검증

## 4. 자연광 환경 대응 전략

### 4.1 창 앞 테이핑 맵 설정

**위치 최적화**:
```python
MAP_POSITIONING = {
    "window_distance": "적절한 거리 유지",
    "shadow_avoidance": "그림자 최소화",
    "lighting_consistency": "일정한 조명 확보",
    "camera_angle": "자연광 영향 최소화"
}
```

**조명 제어**:
```python
LIGHTING_CONTROL = {
    "curtains": "블라인드 조절",
    "artificial_light": "형광등 보조",
    "time_consistency": "동일 시간대 수집",
    "weather_monitoring": "날씨 조건 확인"
}
```

### 4.2 데이터 품질 관리

**실시간 모니터링**:
```python
def monitor_lighting_conditions():
    """조명 조건 실시간 모니터링"""
    # 1. 밝기 측정
    brightness = measure_brightness()
    if brightness < threshold_min or brightness > threshold_max:
        print("Warning: Lighting conditions unstable")
        return False
    
    # 2. 그림자 감지
    shadow_detected = detect_shadows()
    if shadow_detected:
        print("Warning: Shadows detected")
        return False
    
    # 3. 일관성 확인
    consistency = check_lighting_consistency()
    if consistency < threshold_consistency:
        print("Warning: Lighting inconsistency")
        return False
    
    return True
```

**품질 검증 기준**:
```python
QUALITY_CRITERIA = {
    "brightness_range": [50, 200],  # 0-255 범위
    "contrast_ratio": 0.3,          # 최소 대비
    "shadow_tolerance": 0.1,        # 그림자 허용도
    "consistency_threshold": 0.8    # 일관성 임계값
}
```

## 5. 태스크 복잡성 최소화

### 5.1 조명 조건별 태스크 분배

**밤/새벽 시간대 (800개) - 복잡한 태스크**:
```python
COMPLEX_TASKS = {
    "navigation": 320,      # 40%
    "manipulation": 240,    # 30%
    "combined": 240         # 30%
}
```

**낮 시간대 (200개) - 단순한 태스크**:
```python
SIMPLE_TASKS = {
    "basic_navigation": 120,    # 60%
    "simple_manipulation": 80   # 40%
}
```

### 5.2 학습 복잡도 관리

**데이터 분할 전략**:
```python
DATA_SPLIT_STRATEGY = {
    "train": {
        "night_data": 320,      # 40%
        "dawn_data": 320,       # 40%
        "day_data": 160         # 20%
    },
    "val": {
        "night_data": 40,       # 40%
        "dawn_data": 40,        # 40%
        "day_data": 20          # 20%
    },
    "test": {
        "night_data": 40,       # 40%
        "dawn_data": 40,        # 40%
        "day_data": 20          # 20%
    }
}
```

## 6. 예상 효과

### 6.1 학습 효율성 향상

**장점**:
- **일관된 조명 조건**: 80% 데이터가 안정적인 조명
- **태스크 복잡성 감소**: 자연광 변화로 인한 복잡도 최소화
- **높은 데이터 품질**: 일정한 환경에서 수집된 고품질 데이터

**예상 성능**:
- **학습 속도**: 20-30% 향상
- **수렴 안정성**: 크게 개선
- **일반화 성능**: 안정적인 조명 조건으로 향상

### 6.2 데이터 품질 보장

**품질 지표**:
- **이미지 일관성**: 90% 이상
- **조명 안정성**: 85% 이상
- **태스크 성공률**: 80% 이상

## 7. 실행 계획

### 7.1 즉시 실행 (오늘)

1. **환경 테스트**: Branch b131fb5에서 시스템 동작 확인
2. **조명 조건 측정**: 각 시간대별 조명 강도 측정
3. **첫 에피소드 수집**: 밤 시간대 5개 에피소드 테스트

### 7.2 1주차 목표

1. **밤 시간대 200개 수집**: 일정한 조명 조건에서 집중 수집
2. **데이터 품질 검증**: 수집된 데이터의 일관성 확인
3. **수집 프로세스 최적화**: 효율성 개선

### 7.3 장기 목표

1. **1000개 에피소드 완료**: 3주 내 완료
2. **고품질 데이터셋**: 일관된 조명 조건의 데이터셋
3. **학습 준비**: LoRA Fine-tuning 준비

## 8. 참고 자료

- `RoboVLMs/core/data_collection/current_status_and_plan.md`: 기존 수집 계획
- `RoboVLMs/core/todo_list/mobile_vla_implementation_plan.md`: 전체 구현 계획
- `RoboVLMs/core/comparison_analysis/robovlms_vs_mobile_vla.md`: 아키텍처 비교
