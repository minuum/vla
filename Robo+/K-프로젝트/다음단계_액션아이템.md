# 🎯 **다음 단계 액션 아이템 - Jetson 환경 실행 가이드**

> 💡 **목적**: NVIDIA Jetson에서 RoboVLMs 로봇카 네비게이션 실험을 즉시 시작할 수 있도록 구체적인 실행 단계 제공

---

## 🚀 **즉시 실행 체크리스트 (Jetson 환경)**

### **⏱️ 1단계: 환경 검증 (30분)**

#### **🔍 시스템 상태 확인**
```bash
# GPU 및 메모리 확인
nvidia-smi
free -h

# CUDA 버전 확인  
nvcc --version

# Docker 상태 확인
docker --version
docker ps

# ROS2 환경 확인
source /opt/ros/humble/setup.bash
ros2 --version
```

#### **📦 RoboVLMs 레포지토리 준비**
```bash
# 1. 최신 코드 동기화 (통합 저장소)
cd ~/dev/vla  # 또는 작업 디렉토리
git pull origin feature-action

# 2. RoboVLMs 디렉토리로 이동
cd RoboVLMs

# 3. 환경 활성화
conda activate robovlms
# 또는 Python 가상환경 활성화

# 4. 필요한 스크립트 생성 (현재 누락 상태)
echo "⚠️ 핵심 스크립트들을 재생성해야 합니다"
```

#### **🧪 기본 모델 로딩 테스트**
```bash
# PaliGemma 모델 로딩 테스트 (가장 중요!)
python -c "
import torch
print(f'CUDA 사용가능: {torch.cuda.is_available()}')
print(f'GPU 메모리: {torch.cuda.get_device_properties(0).total_memory / 1e9:.1f}GB')

from transformers import PaliGemmaForConditionalGeneration
model = PaliGemmaForConditionalGeneration.from_pretrained(
    'google/paligemma-3b-mix-224',
    torch_dtype=torch.bfloat16,
    device_map='auto'
)
print('✅ PaliGemma-3B 로딩 성공')
print(f'메모리 사용량: {torch.cuda.memory_allocated() / 1e9:.1f}GB')
"
```

### **⏱️ 2단계: 누락된 핵심 스크립트 재생성 (1시간)**

#### **🎯 우선순위 1: jetson_quick_start.sh**
```bash
# 환경 자동 설정 스크립트 (재생성 필요)
# 기능: CUDA, ROS2, Python 환경 자동 검증 및 설정
# 위치: RoboVLMs/jetson_quick_start.sh
```

#### **🎯 우선순위 2: launch_event_triggered_vla.sh**  
```bash
# Event-Triggered VLA 시스템 실행 스크립트 (재생성 필요)
# 기능: Docker 컨테이너 실행, ROS2 노드 시작, VLA 모델 로딩
# 위치: RoboVLMs/launch_event_triggered_vla.sh
```

#### **🎯 우선순위 3: send_text_command.sh**
```bash
# 텍스트 명령 전송 스크립트 (재생성 필요)  
# 기능: 사용자 명령을 VLA 시스템에 전송
# 위치: RoboVLMs/send_text_command.sh
```

### **⏱️ 3단계: ROS2Calvin 데이터셋 검증 (1시간)**

#### **🗂️ 데이터셋 로딩 테스트 (구현 필요)**
```bash
# ROS2Calvin 데이터셋 테스트 (코드 복구 필요)
python -c "
# from robovlms.data.ros2_calvin_dataset import ROS2CalvinDataset
# 현재 누락 상태 - 재구현 필요
print('⚠️ ROS2Calvin 데이터셋 코드 복구 필요')
"
```

---

## 📋 **주요 실행 명령어 치트 시트 (복구 필요)**

### **🎮 시스템 제어 (현재 누락)**
```bash
# 시스템 시작 (재생성 필요)
# ./launch_event_triggered_vla.sh

# 시스템 종료 (재생성 필요)  
# ./stop_event_triggered_vla.sh

# 컨테이너 상태 확인
docker ps
# docker logs k_project_event_vla
```

### **📝 명령어 전송 (현재 누락)**
```bash
# 단일 명령어 (재생성 필요)
# ./send_text_command.sh "앞으로 가"
# ./send_text_command.sh "멈춰"  
# ./send_text_command.sh "컵으로 가"

# 대화형 모드 (재생성 필요)
# ./send_text_command.sh -i
```

### **📊 모니터링 (설정 필요)**
```bash
# 실시간 이벤트 로그 (로그 시스템 재구축 필요)
# tail -f logs/event_triggered_vla/latest/vla_events.log

# ROS2 토픽 모니터링
ros2 topic echo /cmd_vel  # 기본 움직임 명령
ros2 topic echo /scan     # LiDAR 데이터
```

---

## ⚠️ **긴급 복구 작업 목록**

### **🚨 즉시 필요한 파일들**

#### **1. 핵심 실행 스크립트들**
- [ ] **jetson_quick_start.sh** - 환경 자동 설정
- [ ] **launch_event_triggered_vla.sh** - 시스템 실행  
- [ ] **send_text_command.sh** - 명령 전송
- [ ] **stop_event_triggered_vla.sh** - 안전한 종료

#### **2. 설정 파일들**
- [ ] **docker-compose.yml** - 컨테이너 설정
- [ ] **configs/k_project/ros2_automotive.json** - K-프로젝트 설정

#### **3. 핵심 Python 모듈들**
- [ ] **robovlms/data/ros2_calvin_dataset.py** - 데이터셋 처리
- [ ] **robovlms/data/calvin_to_ros2_converter.py** - 액션 변환
- [ ] **robovlms/model/policy_head/ros2_policy.py** - ROS2 정책 헤드

### **🔧 복구 우선순위**

#### **Priority 1: 기본 실행 환경 (오늘)**
1. jetson_quick_start.sh 재생성
2. 기본 Docker 설정 복구
3. ROS2 환경 검증

#### **Priority 2: Event-Triggered 시스템 (1-2일)**  
1. launch_event_triggered_vla.sh 재생성
2. VLA 모델 로딩 스크립트 복구
3. 기본 명령 테스트 시스템

#### **Priority 3: Sequential Task 시스템 (1주)**
1. Calvin 스타일 평가 코드 재구현
2. 5개 연속 태스크 시퀀스 정의
3. 성능 측정 시스템 구축

---

## 🎯 **즉시 실행 가능한 임시 해결책**

### **📝 기본 테스트 스크립트 (임시)**
```bash
#!/bin/bash
# 임시 테스트 스크립트 - basic_test.sh

# 1. 환경 확인
echo "🔍 시스템 환경 확인"
python -c "
import torch
print(f'CUDA: {torch.cuda.is_available()}')
print(f'GPU 메모리: {torch.cuda.get_device_properties(0).total_memory / 1e9:.1f}GB')
"

# 2. ROS2 확인  
echo "🤖 ROS2 환경 확인"
source /opt/ros/humble/setup.bash
ros2 --version

# 3. 기본 PaliGemma 테스트
echo "🧠 PaliGemma 로딩 테스트"
python -c "
from transformers import PaliGemmaForConditionalGeneration
model = PaliGemmaForConditionalGeneration.from_pretrained(
    'google/paligemma-3b-mix-224',
    torch_dtype='bfloat16'
)
print('✅ 모델 로딩 성공')
"
```

---

## 📊 **성능 체크 포인트**

### **✅ 정상 동작 기준 (복구 후)**
```python
performance_checkpoints = {
    "model_loading": "< 30초",
    "inference_latency": "< 100ms", 
    "memory_usage": "< 14GB",
    "command_response": "< 2초",
    "safety_reaction": "< 200ms"
}
```

---

## 🔜 **복구 완료 후 다음 단계**

### **📈 단기 목표 (1-2주)**
1. **네비게이션 데이터 수집**: 기본 시연 100개
2. **Sequential Task 구현**: 5개 연속 태스크 시퀀스
3. **성능 평가**: Calvin 스타일 평가 시스템

### **📅 중기 목표 (1개월)**
1. **논문 실험**: Calvin vs K-프로젝트 성능 비교
2. **Jetson 최적화**: 메모리 효율성 개선
3. **안전 시스템**: 실시간 충돌 회피 구현

---

## 💬 **대화 재개 시 참조 파일**
1. **전체 맥락**: `Robo+/K-프로젝트/RoboVLMs_실험설계_대화요약_20250725.md`
2. **Git 가이드**: `Robo+/K-프로젝트/Git_커밋_가이드.md` (재생성 필요)
3. **다음 단계**: 이 파일 (`다음단계_액션아이템.md`)

---

**💡 핵심**: 현재 핵심 스크립트들이 누락된 상태이므로, 먼저 기본 실행 환경을 복구한 후 단계적으로 기능을 구현해야 합니다!

**📅 마지막 업데이트**: 2025년 7월 25일