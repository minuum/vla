=========================================
Mobile VLA LoRA Fine-tuning
Date: 2025-11-14
=========================================

üìÑ Config: ../Mobile_VLA/configs/mobile_vla_20251114_lora.json
üîß Device: CUDA
üì¶ Model: Kosmos-2 with LoRA

üîç CUDA ÌôïÏù∏...
CUDA available: False
CUDA device: N/A

üìä Îç∞Ïù¥ÌÑ∞ÏÖã ÌôïÏù∏...
  - Found 124 episodes matching pattern 'episode_2025111*.h5'
  ‚úÖ Episodes found

üöÄ LoRA Fine-tuning ÏãúÏûë...
   - Using RoboVLMs main.py
   - Dataset: MobileVLAH5Dataset
   - LoRA: r=32, alpha=16, dropout=0.1
   - Epochs: 20

/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py:14: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Traceback (most recent call last):
  File "/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py", line 132, in _check_requirement
    pkg_resources.require(self.requirement)
  File "/home/billy/.local/lib/python3.10/site-packages/pkg_resources/__init__.py", line 1065, in require
    needed = self.resolve(parse_requirements(requirements))
  File "/home/billy/.local/lib/python3.10/site-packages/pkg_resources/__init__.py", line 892, in resolve
    dist = self._resolve_dist(
  File "/home/billy/.local/lib/python3.10/site-packages/pkg_resources/__init__.py", line 938, in _resolve_dist
    raise VersionConflict(dist, req).with_context(dependent_req)
pkg_resources.ContextualVersionConflict: (torch 2.1.2+cpu (/home/billy/.local/lib/python3.10/site-packages), Requirement.parse('torch==2.2.2'), {'torchvision'})

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/billy/25-1kp/vla/RoboVLMs_upstream/main.py", line 12, in <module>
    from lightning.pytorch.callbacks import LearningRateMonitor, ModelCheckpoint
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/__init__.py", line 21, in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/pytorch/__init__.py", line 27, in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/pytorch/callbacks/__init__.py", line 14, in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/pytorch/callbacks/batch_size_finder.py", line 26, in <module>
    from lightning.pytorch.callbacks.callback import Callback
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/pytorch/callbacks/callback.py", line 22, in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
  File "/home/billy/.local/lib/python3.10/site-packages/lightning/pytorch/utilities/types.py", line 41, in <module>
    from torchmetrics import Metric
  File "/home/billy/.local/lib/python3.10/site-packages/torchmetrics/__init__.py", line 23, in <module>
    from torchmetrics import functional  # noqa: E402
  File "/home/billy/.local/lib/python3.10/site-packages/torchmetrics/functional/__init__.py", line 49, in <module>
    from torchmetrics.functional.detection._deprecated import _panoptic_quality as panoptic_quality
  File "/home/billy/.local/lib/python3.10/site-packages/torchmetrics/functional/detection/__init__.py", line 24, in <module>
    if _TORCHVISION_AVAILABLE and _TORCHVISION_GREATER_EQUAL_0_8:
  File "/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py", line 164, in __bool__
    self._check_available()
  File "/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py", line 158, in _check_available
    self._check_requirement()
  File "/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py", line 142, in _check_requirement
    self.available = module_available(module)
  File "/home/billy/.local/lib/python3.10/site-packages/lightning_utilities/core/imports.py", line 61, in module_available
    importlib.import_module(module_path)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/usr/local/lib/python3.10/dist-packages/torchvision/__init__.py", line 6, in <module>
    from torchvision import _meta_registrations, datasets, io, models, ops, transforms, utils
  File "/usr/local/lib/python3.10/dist-packages/torchvision/_meta_registrations.py", line 164, in <module>
    def meta_nms(dets, scores, iou_threshold):
  File "/home/billy/.local/lib/python3.10/site-packages/torch/_custom_ops.py", line 253, in inner
    custom_op = _find_custom_op(qualname, also_check_torch_library=True)
  File "/home/billy/.local/lib/python3.10/site-packages/torch/_custom_op/impl.py", line 1076, in _find_custom_op
    overload = get_op(qualname)
  File "/home/billy/.local/lib/python3.10/site-packages/torch/_custom_op/impl.py", line 1062, in get_op
    error_not_found()
  File "/home/billy/.local/lib/python3.10/site-packages/torch/_custom_op/impl.py", line 1052, in error_not_found
    raise ValueError(
ValueError: Could not find the operator torchvision::nms. Please make sure you have already registered the operator and (if registered from C++) loaded it via torch.ops.load_library.
